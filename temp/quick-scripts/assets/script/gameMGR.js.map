{"version":3,"sources":["gameMGR.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/script","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class gameMGR extends cc.Component {\n\n  @property(cc.Node)\n  basicofficeNode : cc.Node = null;\n\n  @property(cc.Node)\n  advanceofficeNode : cc.Node = null;\n\n  @property({ type: cc.AudioClip })\n  click_playgame_sound: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  click_bottle_sound: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  click_radio_sound: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  click_restart_sound: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  bgm_success: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  bgm_music: cc.AudioClip = null;\n\n  @property({ type: cc.AudioClip })\n  bgm_amb: cc.AudioClip = null;\n\n  //@property(cc.Node)\n  //radioBtn : cc.Node = null;\n\n  @property(cc.Node)\n  playBtn : cc.Node = null;\n\n  //@property(cc.Node)\n  //bottleBtn : cc.Node = null;\n\n  @property(cc.Node)\n  restartBtn : cc.Node = null;\n\n  @property(cc.Node)\n  exitBtn : cc.Node = null;\n\n  @property(cc.Node)\n  resultText : cc.Node = null;\n\n  private bgm_state: string = \"music\";\n\n\n  @property(cc.Node)\n  timeNode: cc.Node = null;\n\n  @property(cc.Node)\n  scoreNode: cc.Node = null;\n\n  @property(cc.Node)\n  finalscoreNode: cc.Node = null;\n\n  @property(cc.Node)\n  resultNode: cc.Node = null;\n\n  private score: number;\n\n  private totalScore:number;\n\n  private gameTime: number = -1; // remaining time\n\n  private isTimeover: boolean = false; // time out or not\n\n  private isFinish: boolean = false; \n\n  private textContent:string = \"CONGRADULATION\";\n\n  private user_ID;\n\n  private playerStatus;\n\n  private Hscore;\n\n  private officeLevel:string = \"BASIC\";\n\n  restart(){\n    cc.audioEngine.playEffect(this.click_restart_sound,false);\n    cc.log(\"restart\");\n    //this.start_step();\n    cc.director.loadScene(\"working\");\n  }\n\n  exit(){\n    cc.audioEngine.playEffect(this.click_restart_sound,false);\n    cc.log(\"exit\");\n    cc.director.loadScene(\"userInfo\");\n  }\n\n  private finishgame(){// SUCCESS!\n\n    //cc.audioEngine.pauseAll();\n    //cc.audioEngine.playMusic(this.bgm_success,true); //TODO: cannot play \n\n    cc.log(\"SUCCESS!\");\n\n    this.score = this.score + 300;\n\n    //this.score = 600; //TODO:for debug\n\n    this.totalScore = this.totalScore + this.score;\n\n    this.finalscoreNode.getComponent(cc.Label).string = String(this.score);\n    this.resultNode.opacity = 255;\n    this.restartBtn.getComponent(cc.Button).interactable = true;\n    this.exitBtn.getComponent(cc.Button).interactable = true;\n\n    \n\n    if(this.score > this.Hscore){ //new record\n\n      this.textContent = \"NEW RECORD\";\n      \n\n    }\n    else{\n      if(this.score < 500){\n        this.textContent = \"SUCCESS\";\n\n      }\n      else if( this.score >=500 && this.score < 1000){\n        this.textContent = \"NICE JOB\";\n      }\n      else{\n        this.textContent = \"EXCELLENT!\";\n      }\n\n    }\n\n    \n\n    this.resultText.getComponent(cc.Label).string = this.textContent;\n\n    this.isFinish = true;\n    //this.radioBtn.getComponent(cc.Button).interactable = false;\n    this.playBtn.getComponent(cc.Button).interactable = false;\n    //this.bottleBtn.getComponent(cc.Button).interactable = false;\n\n    if(this.officeLevel == \"BASIC\"){\n      this.basicofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = false;\n      this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n\n    \n    }\n    else {\n      \n      this.advanceofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = false;\n      this.advanceofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n  \n      \n      \n    }\n    \n\n    cc.audioEngine.pauseAll();\n\n\n    this.writeUserData();\n\n    \n    \n\n  }\n\n  radio_change(){ // bgm status change\n\n    if(this.bgm_state == \"music\"){\n      cc.audioEngine.pauseMusic();\n      //cc.audioEngine.playMusic(this.bgm_amb,true);\n      this.bgm_state = \"amb\";\n    }\n    else{\n      cc.audioEngine.pauseMusic();\n      //cc.audioEngine.playMusic(this.bgm_music,true);\n      this.bgm_state = \"music\"\n    }\n\n  }\n\n\n  private Timer() {\n    if(this.gameTime == -1) this.gameTime = 40;\n    cc.log(\"start timer:\",this.gameTime);\n\n    this.schedule(function () {\n      this.gameTime -= 1;\n\n      if (this.gameTime <= 0 && this.isTimeover == false) {\n        this.isTimeover = true;\n        this.finishgame();\n        this.gameTime = 0;\n        // jump to another scene or show result directly\n      }\n      cc.log(this.gameTime);\n      if(this.gameTime<0) this.gameTime = 0;\n      this.timeNode.getComponent(cc.Label).string = String(this.gameTime);\n    }, 1);\n  }\n\n  private loadUserData() {\n    var userEmail = firebase.auth().currentUser.email;\n    let split_name = userEmail.split('@');\n    this.user_ID = split_name[0];\n    //this.user_ID = firebase.auth().currentUser.uid;\n\n    var scene = cc.director.getScene().name;\n\n    cc.log(\"read user\" , this.user_ID , \" data\");\n    \n\n    var scorenode = this.scoreNode;\n\n    var ScoreNum = 0;\n\n    var userRef = firebase.database().ref(\"/user/\" + this.user_ID);\n    userRef.once(\"value\", (snapshot) => {\n      cc.log(\n        'total score:',snapshot.val().totalScore,\n        '\\nscore',snapshot.val().Score, //score\n        '\\nminigamescore',snapshot.val().minigameScore,\n        '\\nstatus',snapshot.val().status,\n        '\\ntime',snapshot.val().time\n      );\n\n\n      if(snapshot.val().status == \"start\"){ // NEW GAME\n        cc.log(\"new game\");\n        this.gameTime = 180;\n        this.score = 0;\n        ScoreNum = 0;\n\n\n      } \n      else if(snapshot.val().status == \"endgame\"){\n           cc.log(\"end of mini game\");\n          this.gameTime = snapshot.val().time;\n          var score_main : number = +snapshot.val().Score;\n          var score_mini : number = +snapshot.val().minigameScore;\n          ScoreNum = score_main + score_mini;\n          this.score = ScoreNum;\n        \n\n      } \n\n      scorenode.getComponent(cc.Label).string = ScoreNum.toString();\n\n      this.Hscore = snapshot.val().HScore; //load highest score\n      this.totalScore = snapshot.val().totalScore; //load total score until now\n      this.officeLevel =  snapshot.val().office; //load office\n      cc.log(\"remaining time:\",this.gameTime);\n      cc.log(\"score:\",this.score);\n      cc.log(\"HScore:\", this.Hscore);\n\n      \n    });\n  }\n\n  private writeUserData(){\n\n    var userRef = firebase.database().ref(\"/user/\" + this.user_ID);\n\n    userRef.once(\"value\", (snapshot) => {\n\n      this.Hscore = snapshot.val().HScore;\n      \n    });\n\n    if(this.isFinish == false) //\n    {\n\n      var updateInfo_1 = {\n        'Score':this.score,\n        'status':'endgame',\n        'time':this.gameTime,\n        'minigameScore': '0'\n      };\n\n      userRef.update(updateInfo_1);\n\n    }\n    else{\n      if(this.totalScore > 1000 && this.officeLevel == 'BASIC'){\n        this.officeLevel = \"ADVANCE\";\n      }\n      if(this.score > this.Hscore){ //new record\n        var updateInfo_2 = {\n          office:this.officeLevel,\n          totalScore:this.totalScore,\n          HScore: this.score,\n          Score: '0',\n          status: 'start',\n          time: '180',\n        };\n        userRef.update(updateInfo_2);\n\n      }\n      else{\n        var updateInfo_3 = {\n          office:this.officeLevel,\n          totalScore:this.totalScore,\n          Score: \"0\",\n          status: \"start\",\n          time: \"180\",\n        };\n        userRef.update(updateInfo_3);\n\n      }\n      \n\n\n    }\n\n\n  }\n\n  ToDinosaur(){ // play game at work by btn\n    this.playerStatus = \"playGame\";\n    cc.audioEngine.playEffect(this.click_playgame_sound, false);\n    this.writeUserData(); //TODO:firebase bug\n    cc.audioEngine.pauseAll();\n    cc.log(\"jump to Dino\");\n    cc.director.loadScene('dino_game');\n    \n  }\n\n  ToPacman(){ // go to toilet by btn\n    this.playerStatus = \"goToilet\";\n    cc.audioEngine.playEffect(this.click_bottle_sound, false);\n    this.writeUserData(); //TODO:firebase bug\n    cc.audioEngine.pauseAll();\n    cc.log(\"jump to pacman\");\n    cc.director.loadScene('Pacman');\n\n  }\n\n  \n  onLoad() {\n  \n    //this.loadUserData();//TODO:firebase bug \n    //office setting\n    cc.log(\"initial load:working\");\n    //this.officeLevel = \"BASIC\";\n    \n  }\n  \n\n  \n\n  private start_step(){\n\n    this.isFinish = false;\n    this.isTimeover = false;\n    this.resultNode.opacity = 0;\n\n    //this.radioBtn.getComponent(cc.Button).interactable = true;\n    //this.playBtn.getComponent(cc.Button).interactable = true;\n    //this.bottleBtn.getComponent(cc.Button).interactable = true;\n\n    this.restartBtn.getComponent(cc.Button).interactable = false;\n    this.exitBtn.getComponent(cc.Button).interactable = false;\n\n    if(this.bgm_state == \"music\"){\n      //cc.audioEngine.playMusic(this.bgm_music,true);\n    }\n    else{\n      //cc.audioEngine.playMusic(this.bgm_amb,true);\n    }\n\n    this.Timer();\n    \n  }\n\n  start() {\n    \n    \n    cc.log(\"Start Game!\");\n    cc.audioEngine.pauseAll();\n    this.loadUserData();\n    this.start_step();\n    this.setting();\n    \n\n  }\n\n  setting(){\n    if(this.officeLevel == 'BASIC'){\n      cc.log(\"basic office setting...\");\n      this.basicofficeNode.opacity = 255;\n      this.advanceofficeNode.opacity = 0;\n      this.advanceofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = false;\n      this.advanceofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n      this.basicofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = true;\n      this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = true;\n      cc.log(this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable);\n    }\n    else{\n      cc.log(\"advance office setting...\");\n      this.basicofficeNode.opacity = 0;\n      this.advanceofficeNode.opacity = 255;\n      this.basicofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = false;\n      this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n      this.advanceofficeNode.getChildByName('radio').getComponent(cc.Button).interactable = true;\n      this.advanceofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = true;\n\n\n\n    }\n  }\n\n  update (dt) {\n    ///* TODO:time\n    if(this.gameTime < 33){ // time < 33 -> cannot go to toilet\n      this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n      this.advanceofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = false;\n    }\n    else{\n      if(this.officeLevel==\"BASIC\"){\n        this.basicofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = true;\n\n      }\n      else{\n        this.advanceofficeNode.getChildByName('coffee').getComponent(cc.Button).interactable = true;\n\n      }\n    }\n    //*/\n  }\n}\n"]}